{"filter":false,"title":"purchase.rb","tooltip":"/app/models/purchase.rb","ace":{"folds":[],"scrolltop":5970.5,"scrollleft":0,"selection":{"start":{"row":485,"column":8},"end":{"row":485,"column":16},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":1013,"mode":"ace/mode/ruby"}},"hash":"ec9c51635ea8c585d844eb158fd1915d279c2a39","undoManager":{"mark":10,"position":10,"stack":[[{"start":{"row":563,"column":6},"end":{"row":563,"column":7},"action":"remove","lines":["d"],"id":55}],[{"start":{"row":563,"column":5},"end":{"row":563,"column":6},"action":"remove","lines":["n"],"id":56}],[{"start":{"row":563,"column":4},"end":{"row":563,"column":5},"action":"remove","lines":["e"],"id":57}],[{"start":{"row":563,"column":2},"end":{"row":563,"column":4},"action":"remove","lines":["  "],"id":58}],[{"start":{"row":556,"column":4},"end":{"row":556,"column":6},"action":"insert","lines":["  "],"id":59}],[{"start":{"row":564,"column":2},"end":{"row":564,"column":4},"action":"insert","lines":["  "],"id":60}],[{"start":{"row":589,"column":5},"end":{"row":607,"column":0},"action":"remove","lines":[" purchase_details =PurchaseDetail.where(purchase_id: self.id)","    ","      for ip in purchase_details","                ","        #actualiza stock","         stock_product =  Stock.find_by(:product_id => ip.product_id)","","        if stock_product ","           @last_stock = stock_product.quantity - ip.quantity      ","           stock_product.quantity = @last_stock","             ","        else","","          @last_stock = 0","          ","        end ","","        stock_product.save",""],"id":61}],[{"start":{"row":594,"column":5},"end":{"row":594,"column":6},"action":"remove","lines":[" "],"id":62}],[{"start":{"row":594,"column":5},"end":{"row":594,"column":6},"action":"remove","lines":["e"],"id":63}],[{"start":{"row":594,"column":5},"end":{"row":594,"column":6},"action":"remove","lines":["n"],"id":64}],[{"start":{"row":594,"column":5},"end":{"row":594,"column":6},"action":"remove","lines":["d"],"id":65}]]},"timestamp":1542922680952}